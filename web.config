<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <rewrite>
        <allowedServerVariables>
            <add name="HTTP_X_FORWARDED_HOST" />
            <add name="HTTP_X_FORWARDED_PROTO" />
            <add name="HTTP_X_FORWARDED_PORT" />
        </allowedServerVariables>
        <rules>
            <rule name="ReverseProxyInboundRule1" stopProcessing="true">
                <match url="(.*)" />
                <serverVariables>
                    <set name="HTTP_X_FORWARDED_HOST" value="{HTTP_HOST}" />
                    <set name="HTTP_X_FORWARDED_PORT" value="{SERVER_PORT}" />
                </serverVariables>
            </rule>
        </rules>
    </rewrite>
    <handlers>
      <add name="httpPlatformHandler" path="*" verb="*" modules="httpPlatformHandler" resourceType="Unspecified" />
    </handlers>
    <httpPlatform stdoutLogEnabled="true"
        stdoutLogFile="%HOME%\LogFiles\stdout"
        processPath="%JAVA_HOME%\bin\java.exe"
        arguments="-Djava.net.preferIPv4Stack=true -Dserver.port=%HTTP_PLATFORM_PORT% -jar &quot;%HOME%\site\wwwroot\dm-store.jar&quot;">
    </httpPlatform>
  </system.webServer>
</configuration>
